<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>KaboreTech - Admin</title>
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
    />
    <style>
      :root {
        --primary: #667eea;
        --primary-dark: #5a6fd8;
        --primary-light: #7c88ee;
        --secondary: #764ba2;
        --success: #10b981;
        --warning: #f59e0b;
        --danger: #ef4444;
        --dark: #1f2937;
        --light: #f9fafb;
        --gray: #6b7280;
        --gray-light: #f3f4f6;
        --border: #e5e7eb;
        --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1),
          0 2px 4px -1px rgba(0, 0, 0, 0.06);
        --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1),
          0 4px 6px -2px rgba(0, 0, 0, 0.05);
        --gradient-primary: linear-gradient(
          135deg,
          var(--primary) 0%,
          var(--secondary) 100%
        );
        --gradient-card: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      }

      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body {
        font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        color: var(--dark);
        line-height: 1.6;
        min-height: 100vh;
        display: flex;
      }

      /* Sidebar */
      .sidebar {
        width: 280px;
        background: var(--dark);
        color: white;
        height: 100vh;
        position: fixed;
        padding: 0;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        z-index: 1000;
        box-shadow: var(--shadow-lg);
      }

      .sidebar-header {
        padding: 30px 25px;
        background: var(--gradient-primary);
        text-align: center;
        position: relative;
        overflow: hidden;
      }

      .sidebar-header::before {
        content: "";
        position: absolute;
        top: -50%;
        right: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(
          circle,
          rgba(255, 255, 255, 0.1) 0%,
          transparent 70%
        );
        animation: pulse 4s ease-in-out infinite;
      }

      @keyframes pulse {
        0%,
        100% {
          transform: scale(1) rotate(0deg);
          opacity: 0.3;
        }
        50% {
          transform: scale(1.1) rotate(180deg);
          opacity: 0.1;
        }
      }

      .sidebar-header h3 {
        font-size: 1.8rem;
        font-weight: 700;
        letter-spacing: -0.5px;
        position: relative;
        z-index: 2;
      }

      .sidebar-menu {
        padding: 20px 0;
      }

      .sidebar-menu ul {
        list-style: none;
      }

      .sidebar-menu a {
        display: flex;
        align-items: center;
        padding: 16px 25px;
        color: #d1d5db;
        text-decoration: none;
        font-size: 0.95rem;
        font-weight: 500;
        transition: all 0.3s ease;
        position: relative;
        margin: 4px 15px;
        border-radius: 12px;
      }

      .sidebar-menu a::before {
        content: "";
        position: absolute;
        left: 0;
        top: 0;
        width: 0;
        height: 100%;
        background: var(--gradient-primary);
        border-radius: 12px;
        transition: width 0.3s ease;
        z-index: -1;
      }

      .sidebar-menu a:hover::before,
      .sidebar-menu a.active::before {
        width: 100%;
      }

      .sidebar-menu a:hover,
      .sidebar-menu a.active {
        color: white;
        transform: translateX(8px);
      }

      .sidebar-menu i {
        margin-right: 15px;
        width: 20px;
        text-align: center;
        font-size: 1.1rem;
      }

      /* Main Content */
      .main-content {
        flex: 1;
        margin-left: 280px;
        padding: 30px;
        transition: margin-left 0.3s ease;
      }

      .header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 25px 0;
        margin-bottom: 40px;
        background: white;
        border-radius: 20px;
        padding: 25px 30px;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
      }

      .header h2 {
        color: var(--dark);
        font-weight: 700;
        font-size: 2rem;
        background: var(--gradient-primary);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
      }

      .user-info {
        display: flex;
        align-items: center;
        padding: 12px 20px;
        background: var(--gray-light);
        border-radius: 50px;
        box-shadow: var(--shadow);
      }

      .user-info img {
        border-radius: 50%;
        margin-right: 12px;
        border: 3px solid var(--primary);
      }

      .user-info span {
        font-weight: 600;
        color: var(--dark);
      }

      /* Cards */
      .cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 25px;
        margin-bottom: 40px;
      }

      .card {
        background: white;
        border-radius: 20px;
        padding: 30px;
        box-shadow: var(--shadow);
        border: 1px solid var(--border);
        position: relative;
        overflow: hidden;
        transition: all 0.3s ease;
      }

      .card::before {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 6px;
        background: var(--gradient-primary);
      }

      .card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-lg);
      }

      .card.total::before {
        background: var(--gradient-primary);
      }
      .card.paid::before {
        background: linear-gradient(135deg, var(--success) 0%, #059669 100%);
      }
      .card.free::before {
        background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
      }

      .card h3 {
        font-size: 0.9rem;
        color: var(--gray);
        margin-bottom: 12px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .card p {
        font-size: 2.5rem;
        font-weight: 800;
        color: var(--dark);
        margin-bottom: 8px;
      }

      .card .trend {
        font-size: 0.85rem;
        color: var(--success);
        display: flex;
        align-items: center;
      }

      /* Table & List */
      .table-container {
        background: white;
        border-radius: 20px;
        box-shadow: var(--shadow);
        padding: 30px;
        margin-bottom: 30px;
        border: 1px solid var(--border);
      }

      .table-container h3 {
        margin-bottom: 25px;
        color: var(--dark);
        font-weight: 700;
        font-size: 1.3rem;
      }

      table {
        width: 100%;
        border-collapse: collapse;
      }

      th {
        background: var(--gray-light);
        padding: 18px 20px;
        text-align: left;
        font-weight: 700;
        color: var(--dark);
        font-size: 0.9rem;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        border: none;
      }

      th:first-child {
        border-radius: 12px 0 0 12px;
      }
      th:last-child {
        border-radius: 0 12px 12px 0;
      }

      td {
        padding: 18px 20px;
        border-bottom: 1px solid var(--border);
        font-weight: 500;
      }

      tr:hover {
        background: var(--light);
      }

      tr:last-child td {
        border-bottom: none;
      }

      .status {
        padding: 8px 16px;
        border-radius: 50px;
        font-size: 0.8rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.5px;
      }

      .status.paid {
        background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
        color: var(--success);
        border: 2px solid var(--success);
      }

      .status.free {
        background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
        color: var(--warning);
        border: 2px solid var(--warning);
      }

      .action-btn {
        padding: 10px 12px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        margin-right: 8px;
        font-size: 0.9rem;
        transition: all 0.3s ease;
        font-weight: 600;
      }

      .action-btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow);
      }

      .edit-btn {
        background: linear-gradient(135deg, var(--warning) 0%, #d97706 100%);
        color: white;
      }

      .delete-btn {
        background: linear-gradient(135deg, var(--danger) 0%, #dc2626 100%);
        color: white;
      }

      .reset-btn {
        background: var(--gradient-primary);
        color: white;
      }

      /* Form */
      .form-container {
        background: white;
        border-radius: 20px;
        box-shadow: var(--shadow);
        padding: 35px;
        border: 1px solid var(--border);
      }

      .form-container h3 {
        margin-bottom: 30px;
        color: var(--dark);
        font-weight: 700;
        font-size: 1.5rem;
      }

      .form-group {
        margin-bottom: 25px;
      }

      label {
        display: block;
        margin-bottom: 10px;
        font-weight: 600;
        color: var(--dark);
        font-size: 0.95rem;
      }

      .form-control {
        width: 100%;
        padding: 15px 18px;
        border: 2px solid var(--border);
        border-radius: 12px;
        font-size: 1rem;
        transition: all 0.3s ease;
        background: white;
      }

      .form-control:focus {
        outline: none;
        border-color: var(--primary);
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
      }

      /* Tabs */
      .tabs {
        display: flex;
        margin-bottom: 30px;
        background: var(--gray-light);
        border-radius: 15px;
        padding: 8px;
        box-shadow: inset var(--shadow);
      }

      .tab {
        padding: 15px 25px;
        cursor: pointer;
        background: transparent;
        border: none;
        border-radius: 10px;
        font-weight: 600;
        transition: all 0.3s ease;
        color: var(--gray);
        flex: 1;
        text-align: center;
      }

      .tab.active {
        background: white;
        color: var(--primary);
        box-shadow: var(--shadow);
        transform: translateY(-2px);
      }

      .tab-content {
        display: none;
      }

      .tab-content.active {
        display: block;
        animation: fadeIn 0.5s ease;
      }

      @keyframes fadeIn {
        from {
          opacity: 0;
          transform: translateY(20px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }

      /* Upload Progress */
      .upload-progress {
        margin-top: 20px;
        display: none;
      }

      .progress-bar {
        height: 10px;
        background: var(--gray-light);
        border-radius: 50px;
        overflow: hidden;
        box-shadow: inset var(--shadow);
      }

      .progress-fill {
        height: 100%;
        width: 0%;
        background: var(--gradient-primary);
        transition: width 0.3s ease;
        border-radius: 50px;
        position: relative;
      }

      .progress-fill::after {
        content: "";
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(
          45deg,
          transparent 30%,
          rgba(255, 255, 255, 0.3) 50%,
          transparent 70%
        );
        animation: shimmer 2s infinite;
      }

      @keyframes shimmer {
        0% {
          transform: translateX(-100%);
        }
        100% {
          transform: translateX(100%);
        }
      }

      .progress-text {
        font-size: 0.9rem;
        margin-top: 8px;
        color: var(--gray);
        text-align: center;
        font-weight: 600;
      }

      /* Alert */
      .alert {
        padding: 16px 20px;
        margin-bottom: 20px;
        border-radius: 12px;
        font-size: 0.9rem;
        font-weight: 600;
        border: 2px solid;
        display: flex;
        align-items: center;
      }

      .alert i {
        margin-right: 10px;
        font-size: 1.1rem;
      }

      .alert-success {
        background: linear-gradient(135deg, #d1fae5 0%, #a7f3d0 100%);
        color: var(--success);
        border-color: var(--success);
      }

      .alert-danger {
        background: linear-gradient(135deg, #fee2e2 0%, #fecaca 100%);
        color: var(--danger);
        border-color: var(--danger);
      }

      /* Modal */
      .modal {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        z-index: 2000;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(8px);
      }

      .modal-content {
        background: white;
        padding: 35px;
        border-radius: 20px;
        width: 90%;
        max-width: 500px;
        box-shadow: var(--shadow-lg);
        border: 1px solid var(--border);
        transform: scale(0.9);
        transition: transform 0.3s ease;
      }

      .modal.show .modal-content {
        transform: scale(1);
      }

      .close {
        float: right;
        font-size: 28px;
        font-weight: bold;
        cursor: pointer;
        color: var(--gray);
        transition: color 0.3s ease;
      }

      .close:hover {
        color: var(--danger);
      }

      /* Buttons */
      .btn {
        padding: 15px 30px;
        border: none;
        border-radius: 12px;
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        transition: all 0.3s ease;
        text-transform: uppercase;
        letter-spacing: 0.5px;
        display: inline-flex;
        align-items: center;
        gap: 10px;
      }

      .btn:hover {
        transform: translateY(-3px);
        box-shadow: var(--shadow-lg);
      }

      .btn-primary {
        background: var(--gradient-primary);
        color: white;
      }

      .btn-secondary {
        background: linear-gradient(135deg, var(--gray) 0%, #4b5563 100%);
        color: white;
      }

      .btn i {
        font-size: 1.1rem;
      }

      /* Loading */
      .loading {
        text-align: center;
        color: var(--gray);
        font-style: italic;
        padding: 30px;
      }

      /* Responsive */
      @media (max-width: 1024px) {
        .sidebar {
          width: 80px;
          overflow: hidden;
        }

        .sidebar-header h3 {
          font-size: 0;
        }

        .sidebar-header h3::after {
          content: "KT";
          font-size: 1.5rem;
        }

        .sidebar-menu span {
          display: none;
        }

        .sidebar-menu i {
          font-size: 1.4rem;
          margin-right: 0;
        }

        .main-content {
          margin-left: 80px;
        }
      }

      @media (max-width: 768px) {
        .main-content {
          margin-left: 0;
          padding: 20px;
        }

        .sidebar {
          transform: translateX(-100%);
        }

        .sidebar.mobile-open {
          transform: translateX(0);
        }

        .cards {
          grid-template-columns: 1fr;
        }

        .header {
          flex-direction: column;
          gap: 15px;
        }

        .table-container {
          overflow-x: auto;
        }
      }

      /* Custom Scrollbar */
      ::-webkit-scrollbar {
        width: 8px;
      }

      ::-webkit-scrollbar-track {
        background: var(--gray-light);
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb {
        background: var(--gradient-primary);
        border-radius: 10px;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: var(--primary-dark);
      }

      /* Animations */
      .slide-in {
        animation: slideIn 0.5s ease;
      }

      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateX(-20px);
        }
        to {
          opacity: 1;
          transform: translateX(0);
        }
      }

      .bounce {
        animation: bounce 0.6s ease;
      }

      @keyframes bounce {
        0%,
        20%,
        50%,
        80%,
        100% {
          transform: translateY(0);
        }
        40% {
          transform: translateY(-10px);
        }
        60% {
          transform: translateY(-5px);
        }
      }
    </style>
  </head>
  <body>
    <!-- Sidebar -->
    <div class="sidebar">
      <div class="sidebar-header">
        <h3>KaboreTech</h3>
      </div>
      <div class="sidebar-menu">
        <ul>
          <li>
            <a href="#" class="active menu-item" data-section="dashboard"
              ><i class="fas fa-tachometer-alt"></i>
              <span>Tableau de Bord</span></a
            >
          </li>
          <li>
            <a href="#" class="menu-item" data-section="videos"
              ><i class="fas fa-video"></i> <span>Vidéos</span></a
            >
          </li>
          <li>
            <a href="#" class="menu-item" data-section="users"
              ><i class="fas fa-users"></i> <span>Utilisateurs</span></a
            >
          </li>
          <li>
            <a href="#" class="menu-item" data-section="settings"
              ><i class="fas fa-cog"></i> <span>Paramètres</span></a
            >
          </li>
        </ul>
      </div>
    </div>

    <!-- Main Content -->
    <div class="main-content">
      <div class="header">
        <h2 id="page-title">Tableau de Bord</h2>
        <div class="user-info">
          <img
            src="https://ui-avatars.com/api/?name=Admin&background=667eea&color=fff"
            alt="Admin"
            width="45"
            height="45"
          />
          <span>Administrateur</span>
        </div>
      </div>

      <!-- Dashboard -->
      <section id="dashboard-section" class="section active slide-in">
        <div class="cards">
          <div class="card total bounce">
            <h3>Total Vidéos</h3>
            <p id="total-videos">0</p>
            <div class="trend">
              <i class="fas fa-arrow-up"></i>
              <span>+12% ce mois</span>
            </div>
          </div>
          <div class="card paid bounce" style="animation-delay: 0.1s">
            <h3>Vidéos Payantes</h3>
            <p id="paid-videos">0</p>
            <div class="trend">
              <i class="fas fa-arrow-up"></i>
              <span>+8% ce mois</span>
            </div>
          </div>
          <div class="card free bounce" style="animation-delay: 0.2s">
            <h3>Vidéos Gratuites</h3>
            <p id="free-videos">0</p>
            <div class="trend">
              <i class="fas fa-arrow-up"></i>
              <span>+15% ce mois</span>
            </div>
          </div>
        </div>

        <div class="table-container">
          <h3><i class="fas fa-clock"></i> Vidéos Récentes</h3>
          <table id="recent-videos-table">
            <thead>
              <tr>
                <th>Titre</th>
                <th>Catégorie</th>
                <th>Partie</th>
                <th>Type</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td colspan="5" class="loading">Chargement des données...</td>
              </tr>
            </tbody>
          </table>
        </div>
      </section>

      <!-- Videos -->
      <section id="videos-section" class="section">
        <div class="tabs">
          <div class="tab active" data-tab="videos-list">
            <i class="fas fa-list"></i>
            Liste des Vidéos
          </div>
          <div class="tab" data-tab="add-video">
            <i class="fas fa-plus"></i>
            Ajouter une Vidéo
          </div>
        </div>

        <div class="tab-content active" id="videos-list-tab">
          <div class="table-container">
            <table id="videos-table">
              <thead>
                <tr>
                  <th>Titre</th>
                  <th>Catégorie</th>
                  <th>Partie</th>
                  <th>Type</th>
                  <th>Description</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="6" class="loading">Chargement des vidéos...</td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="tab-content" id="add-video-tab">
          <div class="form-container">
            <h3 id="video-form-title">
              <i class="fas fa-video"></i> Ajouter une Vidéo
            </h3>
            <div id="video-alert"></div>
            <form id="video-form">
              <div class="form-group">
                <label for="title"><i class="fas fa-heading"></i> Titre</label>
                <input
                  type="text"
                  id="title"
                  class="form-control"
                  required
                  placeholder="Entrez le titre de la vidéo"
                />
              </div>

              <div class="form-group">
                <label for="isPaid"><i class="fas fa-tag"></i> Type</label>
                <select id="isPaid" class="form-control" required>
                  <option value="false">Gratuite</option>
                  <option value="true">Payante</option>
                </select>
              </div>

              <div id="category-group">
                <div class="form-group">
                  <label for="category"
                    ><i class="fas fa-folder"></i> Catégorie</label
                  >
                  <select id="category" class="form-control" required>
                    <option value="">Sélectionner une catégorie</option>
                    <option value="Informatique">
                      Maintenance Informatique
                    </option>
                    <option value="Marketing">Marketing Digital</option>
                    <option value="Bureautique">
                      Sécretariat Informatique
                    </option>
                    <option value="GSM">Réparation Téléphone</option>
                  </select>
                </div>

                <div class="form-group">
                  <label for="part"
                    ><i class="fas fa-puzzle-piece"></i> Partie</label
                  >
                  <select id="part" class="form-control" required>
                    <option value="">Sélectionner une partie</option>
                  </select>
                </div>
              </div>

              <div class="form-group">
                <label for="description"
                  ><i class="fas fa-align-left"></i> Description</label
                >
                <textarea
                  id="description"
                  class="form-control"
                  rows="4"
                  required
                  placeholder="Décrivez votre vidéo..."
                ></textarea>
              </div>

              <div class="form-group">
                <label for="videoFile"
                  ><i class="fas fa-film"></i> Fichier Vidéo</label
                >
                <input
                  type="file"
                  id="videoFile"
                  class="form-control"
                  accept="video/*"
                />
              </div>

              <div class="form-group">
                <label for="imageFile"
                  ><i class="fas fa-image"></i> Image de Couverture</label
                >
                <input
                  type="file"
                  id="imageFile"
                  class="form-control"
                  accept="image/*"
                />
              </div>

              <div class="upload-progress">
                <div class="progress-bar">
                  <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div class="progress-text" id="progress-text">0%</div>
              </div>

              <div style="display: flex; gap: 15px; margin-top: 30px">
                <button
                  type="submit"
                  class="btn btn-primary"
                  id="video-submit-btn"
                >
                  <i class="fas fa-save"></i>
                  Ajouter
                </button>
                <button
                  type="button"
                  class="btn btn-secondary"
                  id="cancel-edit-btn"
                  style="display: none"
                >
                  <i class="fas fa-times"></i>
                  Annuler
                </button>
              </div>
            </form>
          </div>
        </div>
      </section>

      <!-- Users -->
      <section id="users-section" class="section">
        <div class="tabs">
          <div class="tab active" data-tab="users-list">
            <i class="fas fa-users"></i>
            Liste des Utilisateurs
          </div>
          <div class="tab" data-tab="add-user">
            <i class="fas fa-user-plus"></i>
            Ajouter un Utilisateur
          </div>
        </div>

        <div class="tab-content active" id="users-list-tab">
          <div class="table-container">
            <table id="users-table">
              <thead>
                <tr>
                  <th>Nom</th>
                  <th>Téléphone</th>
                  <th>Statut</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td colspan="4" class="loading">
                    Chargement des utilisateurs...
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="tab-content" id="add-user-tab">
          <div class="form-container">
            <h3><i class="fas fa-user-plus"></i> Ajouter un Utilisateur</h3>
            <div id="user-alert"></div>
            <form id="user-form">
              <div class="form-group">
                <label><i class="fas fa-user"></i> Nom Complet</label>
                <input
                  type="text"
                  id="user-name"
                  class="form-control"
                  required
                  placeholder="Nom et prénom"
                />
              </div>
              <div class="form-group">
                <label><i class="fas fa-phone"></i> Téléphone</label>
                <input
                  type="text"
                  id="user-phone"
                  class="form-control"
                  placeholder="+226 XX XX XX XX"
                  required
                />
              </div>
              <div class="form-group">
                <label><i class="fas fa-lock"></i> Mot de passe</label>
                <input
                  type="password"
                  id="user-password"
                  class="form-control"
                  required
                  placeholder="Mot de passe sécurisé"
                />
              </div>
              <button type="submit" class="btn btn-primary">
                <i class="fas fa-user-plus"></i>
                Ajouter Utilisateur
              </button>
            </form>
          </div>
        </div>
      </section>

      <!-- Settings -->
      <section id="settings-section" class="section">
        <div class="form-container">
          <h3><i class="fas fa-cog"></i> Paramètres du Système</h3>
          <div class="form-group">
            <label
              style="
                display: flex;
                align-items: center;
                gap: 15px;
                cursor: pointer;
              "
            >
              <input
                type="checkbox"
                id="screen-capture-toggle"
                style="transform: scale(1.5)"
              />
              <span
                ><i class="fas fa-camera"></i> Autoriser la capture
                d'écran</span
              >
            </label>
            <small style="color: var(--gray); margin-top: 10px; display: block">
              Permet aux utilisateurs de faire des captures d'écran de
              l'application
            </small>
          </div>
        </div>
      </section>
    </div>

    <!-- Reset Password Modal -->
    <div id="password-modal" class="modal">
      <div class="modal-content">
        <span class="close">&times;</span>
        <h3><i class="fas fa-key"></i> Réinitialiser le mot de passe</h3>
        <div id="password-alert"></div>
        <form id="password-form">
          <div class="form-group">
            <label><i class="fas fa-phone"></i> Téléphone</label>
            <input type="text" id="reset-phone" class="form-control" readonly />
          </div>
          <div class="form-group">
            <label><i class="fas fa-shield-alt"></i> Code OTP</label>
            <input
              type="text"
              id="reset-otp"
              class="form-control"
              required
              placeholder="Entrez le code OTP"
            />
          </div>
          <div class="form-group">
            <label><i class="fas fa-lock"></i> Nouveau mot de passe</label>
            <input
              type="password"
              id="reset-new-password"
              class="form-control"
              required
              placeholder="Nouveau mot de passe"
            />
          </div>
          <div style="display: flex; gap: 15px; margin-top: 25px">
            <button type="submit" class="btn btn-primary">
              <i class="fas fa-check"></i>
              Réinitialiser
            </button>
            <button type="button" class="btn btn-secondary" id="send-otp-btn">
              <i class="fas fa-paper-plane"></i>
              Envoyer OTP
            </button>
          </div>
        </form>
      </div>
    </div>

    <!-- Mobile Menu Toggle -->
    <button
      id="mobile-menu-toggle"
      style="
        display: none;
        position: fixed;
        top: 20px;
        left: 20px;
        z-index: 1001;
        background: var(--gradient-primary);
        border: none;
        padding: 15px;
        border-radius: 12px;
        color: white;
        font-size: 1.2rem;
      "
    >
      <i class="fas fa-bars"></i>
    </button>
  </body>
   <script>
// ========================
// Configuration
// ========================
const BASE_URL = "https://kaboretech.cursusbf.com";
let currentVideoId = null;

// ========================
// Fonctions utilitaires
// ========================
function showLoading(tableId) {
  const table = document.getElementById(tableId);
  if (!table) {
    console.error(`[showLoading] Table #${tableId} introuvable`);
    return;
  }
  const thead = table.querySelector("thead tr");
  const colCount = thead ? thead.children.length : 6;
  const tbody = table.querySelector("tbody");
  if (!tbody) return;

  tbody.innerHTML = `
    <tr>
      <td colspan="${colCount}" class="loading">
        <i class="fas fa-spinner fa-spin"></i> Chargement...
      </td>
    </tr>
  `;
}

function showError(tableId, message) {
  const table = document.getElementById(tableId);
  if (!table) return;
  const thead = table.querySelector("thead tr");
  const colCount = thead ? thead.children.length : 6;
  const tbody = table.querySelector("tbody");
  if (!tbody) return;

  tbody.innerHTML = `
    <tr>
      <td colspan="${colCount}" class="loading" style="color: var(--danger);">
        <i class="fas fa-exclamation-triangle"></i> ${message}
      </td>
    </tr>
  `;
}

function showAlert(elementId, message, type = "info") {
  const container = document.getElementById(elementId);
  if (!container) return;
  container.innerHTML = `
    <div class="alert alert-${type}">
      <i class="fas fa-bell"></i> ${message}
    </div>
  `;
  setTimeout(() => {
    if (container.innerHTML.includes(message)) {
      container.innerHTML = "";
    }
  }, 5000);
}

// ========================
// Initialisation au chargement complet du DOM
// ========================
document.addEventListener("DOMContentLoaded", function () {
  // ✅ Réinitialiser les éléments DOM ici
  const sections = {
    dashboard: document.getElementById("dashboard-section"),
    videos: document.getElementById("videos-section"),
    users: document.getElementById("users-section"),
    settings: document.getElementById("settings-section"),
  };

  const tabs = document.querySelectorAll(".tab");
  const tabContents = document.querySelectorAll(".tab-content");
  const menuItems = document.querySelectorAll(".menu-item");
  const pageTitle = document.getElementById("page-title");
  const sidebar = document.querySelector(".sidebar");

  // ========================
  // Navigation
  // ========================
  function navigateTo(sectionId) {
    Object.values(sections).forEach(s => s.classList.remove("active"));
    if (sections[sectionId]) {
      sections[sectionId].classList.add("active");
    }

    menuItems.forEach(item => {
      item.classList.toggle("active", item.dataset.section === sectionId);
    });

    pageTitle.textContent = document.querySelector(`.menu-item[data-section="${sectionId}"] span`)?.textContent || "";
  }

  menuItems.forEach(item => {
    item.addEventListener("click", (e) => {
      e.preventDefault();
      navigateTo(item.dataset.section);
    });
  });

  tabs.forEach(tab => {
    tab.addEventListener("click", () => {
      tabs.forEach(t => t.classList.remove("active"));
      tabContents.forEach(c => c.classList.remove("active"));
      tab.classList.add("active");
      const target = document.getElementById(tab.dataset.tab);
      if (target) target.classList.add("active");
    });
  });

  // Bouton mobile
  window.initMobileMenu = () => {
    const menuBtn = document.querySelector(".menu-btn");
    if (menuBtn) {
      menuBtn.addEventListener("click", () => sidebar.classList.toggle("active"));
    }
  };
  initMobileMenu();

  // Thème sombre
  const darkModeToggle = document.getElementById("dark-mode-toggle");
  if (darkModeToggle) {
    darkModeToggle.addEventListener("click", () => {
      document.body.classList.toggle("dark-theme");
      darkModeToggle.innerHTML = document.body.classList.contains("dark-theme")
        ? '<i class="fas fa-sun"></i>'
        : '<i class="fas fa-moon"></i>';
    });
  }

  // ========================
  // Dashboard
  // ========================
  async function loadDashboardData() {
    try {
      showLoading("recent-videos-table");
      const res = await fetch(`${BASE_URL}/api/videos`);
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();

      const total = data.reduce((acc, cat) => acc + cat.videos.length, 0);
      const paid = data.reduce((acc, cat) => acc + cat.videos.filter(v => v.isPaid).length, 0);
      const free = total - paid;

      animateCounter("total-videos", total);
      animateCounter("paid-videos", paid);
      animateCounter("free-videos", free);

      const recentVideos = [];
      data.forEach(cat => {
        cat.videos.forEach(v => {
          recentVideos.push({ ...v, categoryName: cat.name });
        });
      });

      recentVideos.sort((a, b) => b.id.localeCompare(a.id));
      const latest = recentVideos.slice(0, 5);

      const tbody = document.getElementById("recent-videos-table").querySelector("tbody");
      tbody.innerHTML = "";

      latest.forEach(video => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td style="font-weight: 600;">${video.title}</td>
          <td><span style="background: var(--gray-light); padding: 4px 12px; border-radius: 20px; font-size: 0.85rem;">${video.categoryName}</span></td>
          <td><span style="background: var(--gray-light); padding: 4px 12px; border-radius: 20px; font-size: 0.85rem;">${video.part}</span></td>
          <td><span class="status ${video.isPaid ? 'paid' : 'free'}">${video.isPaid ? 'Payante' : 'Gratuite'}</span></td>
          <td>
            <button class="action-btn edit-btn" data-id="${video.id}" title="Modifier"><i class="fas fa-edit"></i></button>
            <button class="action-btn delete-btn" data-id="${video.id}" title="Supprimer"><i class="fas fa-trash"></i></button>
          </td>
        `;
        tbody.appendChild(tr);
      });

      addVideoActionHandlers();

    } catch (e) {
      console.error("Erreur dashboard:", e);
      showError("recent-videos-table", `Erreur: ${e.message}`);
    }
  }

  // ========================
  // Vidéos
  // ========================
  async function loadVideos() {
    try {
      showLoading("videos-table");
      const res = await fetch(`${BASE_URL}/api/videos`);
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();

      const tbody = document.getElementById("videos-table").querySelector("tbody");
      tbody.innerHTML = "";

      data.forEach(category => {
        category.videos.forEach(video => {
          const tr = document.createElement("tr");
          const desc = video.details?.description || "Pas de description";
          tr.innerHTML = `
            <td style="font-weight: 600;">${video.title}</td>
            <td><span style="background: var(--gray-light); padding: 4px 12px; border-radius: 20px; font-size: 0.85rem;">${category.name}</span></td>
            <td><span style="background: var(--gray-light); padding: 4px 12px; border-radius: 20px; font-size: 0.85rem;">${video.part}</span></td>
            <td><span class="status ${video.isPaid ? 'paid' : 'free'}">${video.isPaid ? 'Payante' : 'Gratuite'}</span></td>
            <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="${desc}">
              ${desc.length > 50 ? desc.substring(0, 50) + "..." : desc}
            </td>
            <td>
              <button class="action-btn edit-btn" data-id="${video.id}" title="Modifier"><i class="fas fa-edit"></i></button>
              <button class="action-btn delete-btn" data-id="${video.id}" title="Supprimer"><i class="fas fa-trash"></i></button>
            </td>
          `;
          tbody.appendChild(tr);
        });
      });

      addVideoActionHandlers();

    } catch (e) {
      console.error("Erreur videos:", e);
      showError("videos-table", `Échec: ${e.message}`);
    }
  }

  function addVideoActionHandlers() {
    document.querySelectorAll(".edit-btn").forEach(btn => {
      btn.addEventListener("click", (e) => {
        editVideo(e.target.closest("button").dataset.id);
      });
    });

    document.querySelectorAll(".delete-btn").forEach(btn => {
      btn.addEventListener("click", (e) => {
        if (confirm("Supprimer cette vidéo ?")) {
          deleteVideo(e.target.closest("button").dataset.id);
        }
      });
    });
  }

  async function editVideo(id) {
    try {
      const res = await fetch(`${BASE_URL}/api/videos`);
      const data = await res.json();
      let video = null;
      for (const cat of data) {
        video = cat.videos.find(v => v.id === id);
        if (video) break;
      }
      if (!video) throw new Error("Vidéo non trouvée");

      // Remplir le formulaire
      document.getElementById("video-title").value = video.title;
      document.getElementById("video-category").value = video.categoryId;
      document.getElementById("video-part").value = video.part;
      document.getElementById("is-paid").checked = video.isPaid;
      document.getElementById("video-description").value = video.details?.description || "";

      currentVideoId = id;
      document.getElementById("video-form-title").textContent = "Modifier la Vidéo";
      document.getElementById("video-submit-btn").innerHTML = '<i class="fas fa-save"></i> Mettre à jour';
      document.getElementById("cancel-edit-btn").style.display = "inline-flex";
      document.getElementById("category-group").style.display = "block";

      document.querySelector('.tab[data-tab="add-video"]').click();
      showAlert("video-alert", "Mode édition activé", "success");

    } catch (e) {
      console.error("Erreur edit:", e);
      showAlert("video-alert", "Erreur: " + e.message, "danger");
    }
  }

  async function deleteVideo(id) {
    try {
      const res = await fetch(`${BASE_URL}/api/videos/${id}`, { method: "DELETE" });
      if (res.ok) {
        showAlert("video-alert", "Vidéo supprimée", "success");
        loadVideos();
      } else {
        throw new Error("Erreur serveur");
      }
    } catch (e) {
      showAlert("video-alert", "Erreur suppression", "danger");
    }
  }

  // ========================
  // Utilisateurs
  // ========================
  async function loadUsers() {
    try {
      showLoading("users-table");
      const res = await fetch(`${BASE_URL}/api/users`);
      if (!res.ok) throw new Error(`HTTP ${res.status}`);
      const data = await res.json();

      if (!data.success || !Array.isArray(data.users)) {
        throw new Error("Données invalides");
      }

      const tbody = document.getElementById("users-table").querySelector("tbody");
      tbody.innerHTML = "";

      data.users.forEach(u => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td style="font-weight: 600;">
            <div style="display: flex; align-items: center;">
              <div style="width: 40px; height: 40px; border-radius: 50%; background: var(--gradient-primary); display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; margin-right: 12px;">
                ${u.name.trim().charAt(0).toUpperCase()}
              </div>
              ${u.name.trim()}
            </div>
          </td>
          <td style="font-family: monospace; font-weight: 500;">${u.phone}</td>
          <td><span style="font-size: 0.85rem; color: var(--gray);">${getUserStatus(u)}</span></td>
          <td>
            <button class="action-btn reset-btn" data-phone="${u.phone}" title="Réinitialiser">
              <i class="fas fa-key"></i>
            </button>
          </td>
        `;
        tbody.appendChild(tr);
      });

      document.querySelectorAll(".reset-btn").forEach(btn => {
        btn.addEventListener("click", () => openPasswordModal(btn.dataset.phone));
      });

    } catch (e) {
      console.error("Erreur users:", e);
      showError("users-table", `Échec: ${e.message}`);
    }
  }

  function getUserStatus(user) {
    const status = [];
    const map = {
      informatiqueHardware: "Info H",
      informatiqueSoftware: "Info S",
      bureautiqueHardware: "Bureau H",
      bureautiqueSoftware: "Bureau S",
      marketingSocial: "Market S",
      marketingContent: "Market C",
      gsmHardware: "GSM H",
      gsmSoftware: "GSM S"
    };
    Object.keys(map).forEach(key => {
      if (user.status[key]) status.push(map[key]);
    });
    return status.length ? status.join(", ") : "Aucun";
  }

  // ========================
  // Formulaire utilisateur
  // ========================
  document.getElementById("user-form").addEventListener("submit", handleUserSubmit);

  async function handleUserSubmit(e) {
    e.preventDefault();
    const form = e.target;
    const submitBtn = form.querySelector('button[type="submit"]');
    const originalText = submitBtn.innerHTML;
    submitBtn.disabled = true;
    submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Envoi...';

    try {
      const data = {
        name: form["user-name"].value.trim(),
        phone: form["user-phone"].value.trim(),
        password: form["user-password"].value
      };

      const res = await fetch(`${BASE_URL}/register`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      if (res.ok) {
        showAlert("user-alert", "Utilisateur ajouté", "success");
        form.reset();
        loadUsers();
        setTimeout(() => document.querySelector('.tab[data-tab="users-list"]').click(), 1500);
      } else {
        const error = await res.text();
        throw new Error(error || "Erreur serveur");
      }
    } catch (e) {
      showAlert("user-alert", "Erreur: " + e.message, "danger");
    } finally {
      submitBtn.innerHTML = originalText;
      submitBtn.disabled = false;
    }
  }

  // ========================
  // Password Reset
  // ========================
  function openPasswordModal(phone) {
    document.getElementById("reset-phone").value = phone;
    const modal = document.getElementById("password-modal");
    modal.style.display = "flex";
    setTimeout(() => modal.classList.add("show"), 10);
  }

  function closeModal() {
    const modal = document.getElementById("password-modal");
    modal.classList.remove("show");
    setTimeout(() => modal.style.display = "none", 300);
  }

  document.getElementById("send-otp-form").addEventListener("submit", handleSendOTP);
  document.getElementById("reset-password-form").addEventListener("submit", handlePasswordReset);

  async function handleSendOTP(e) {
    e.preventDefault();
    const btn = e.target.querySelector("button[type='submit']");
    const original = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Envoi...';

    try {
      const phone = document.getElementById("reset-phone").value;
      const res = await fetch(`${BASE_URL}/api/send-otp`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ phone })
      });

      if (res.ok) {
        showAlert("password-alert", "Code envoyé", "success");
      } else {
        throw new Error("Échec envoi OTP");
      }
    } catch (e) {
      showAlert("password-alert", "Erreur: " + e.message, "danger");
    } finally {
      btn.innerHTML = original;
      btn.disabled = false;
    }
  }

  async function handlePasswordReset(e) {
    e.preventDefault();
    const form = e.target;
    const btn = form.querySelector("button[type='submit']");
    const original = btn.innerHTML;
    btn.disabled = true;
    btn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Réinitialisation...';

    try {
      const data = {
        phone: form["reset-phone"].value,
        otp: form["otp"].value,
        newPassword: form["new-password"].value
      };

      const res = await fetch(`${BASE_URL}/api/reset-password`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(data)
      });

      if (res.ok) {
        showAlert("password-alert", "Mot de passe réinitialisé", "success");
        closeModal();
      } else {
        throw new Error("Échec réinitialisation");
      }
    } catch (e) {
      showAlert("password-alert", "Erreur: " + e.message, "danger");
    } finally {
      btn.innerHTML = original;
      btn.disabled = false;
    }
  }

  // ========================
  // Paramètres
  // ========================
  async function loadScreenCaptureSetting() {
    try {
      const res = await fetch(`${BASE_URL}/api/screen-capture`);
      const data = await res.json();
      const toggle = document.getElementById("screen-capture-toggle");
      if (toggle) toggle.checked = data.allowScreenCapture;
    } catch (e) {
      console.error("Erreur settings:", e);
    }
  }

  document.getElementById("screen-capture-toggle")?.addEventListener("change", toggleScreenCapture);

  async function toggleScreenCapture() {
    const checkbox = this;
    const enabled = checkbox.checked;
    try {
      const res = await fetch(`${BASE_URL}/api/screen-capture`, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ allowScreenCapture: enabled })
      });
      if (!res.ok) throw new Error("Échec");
      showAlert("settings-alert", `Capture ${enabled ? "activée" : "désactivée"}`, "success");
    } catch (e) {
      checkbox.checked = !enabled;
      showAlert("settings-alert", "Erreur", "danger");
    }
  }

  // ========================
  // Compteurs animés
  // ========================
  function animateCounter(elementId, targetValue) {
    const element = document.getElementById(elementId);
    const duration = 1000;
    const start = parseInt(element.textContent) || 0;
    const startTime = performance.now();
    function update(currentTime) {
      const elapsed = currentTime - startTime;
      const progress = Math.min(elapsed / duration, 1);
      const value = Math.floor(start + (targetValue - start) * progress);
      element.textContent = value;
      if (progress < 1) requestAnimationFrame(update);
    }
    requestAnimationFrame(update);
  }

  // ========================
  // Lancement des données
  // ========================
  loadDashboardData();
  loadUsers();
  loadScreenCaptureSetting();

  // Pour les pages spécifiques
  if (window.location.hash === "#videos" || document.querySelector('[data-section="videos"]').classList.contains("active")) {
    loadVideos();
  }
});
</script>
</html>
